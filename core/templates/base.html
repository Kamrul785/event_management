<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Event Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .mobile-menu-enter {
            animation: slideDown 0.3s ease-out;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .dropdown-enter {
            animation: dropdownSlide 0.2s ease-out;
        }

        @keyframes dropdownSlide {
            from {
                opacity: 0;
                transform: translateY(-5px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
    </style>
</head>

<body class="bg-gray-100 font-sans leading-normal tracking-normal min-h-screen">
    
    {% if request.user.is_authenticated %}
        {% include 'logged_nav.html' %}
    {% else %}
        {% include 'non_logged_nav.html' %}
    {% endif %}
        
    <main class="">
        {% block content %}
        {% endblock %}
    </main>

    <script>
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const menuIcon = document.getElementById('menu-icon');
        const closeIcon = document.getElementById('close-icon');
        
        if (mobileMenuBtn && mobileMenu) {
            let isMenuOpen = false;

            function toggleMobileMenu() {
                isMenuOpen = !isMenuOpen;
                
                if (isMenuOpen) {
                    mobileMenu.classList.remove('hidden');
                    mobileMenu.classList.add('mobile-menu-enter');
                    if (menuIcon) menuIcon.classList.add('hidden');
                    if (closeIcon) closeIcon.classList.remove('hidden');
                    document.body.style.overflow = 'hidden';
                } else {
                    mobileMenu.classList.add('hidden');
                    mobileMenu.classList.remove('mobile-menu-enter');
                    if (menuIcon) menuIcon.classList.remove('hidden');
                    if (closeIcon) closeIcon.classList.add('hidden');
                    document.body.style.overflow = '';
                }
            }

            mobileMenuBtn.addEventListener('click', toggleMobileMenu);

            const mobileMenuLinks = mobileMenu.querySelectorAll('a');
            mobileMenuLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (isMenuOpen) {
                        toggleMobileMenu();
                    }
                });
            });
            window.addEventListener('resize', () => {
                if (window.innerWidth >= 1024 && isMenuOpen) {
                    toggleMobileMenu();
                }
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && isMenuOpen) {
                    toggleMobileMenu();
                }
            });
        }

        // User dropdown functionality (for logged navigation)
        const userDropdownBtn = document.getElementById('user-dropdown-btn');
        const userDropdown = document.getElementById('user-dropdown');
        const dropdownArrow = document.getElementById('dropdown-arrow');

        let isDropdownOpen = false;

        // User dropdown toggle
        function toggleUserDropdown() {
            isDropdownOpen = !isDropdownOpen;
            
            if (isDropdownOpen) {
                userDropdown.classList.remove('hidden');
                userDropdown.classList.add('dropdown-enter');
                dropdownArrow.style.transform = 'rotate(180deg)';
            } else {
                userDropdown.classList.add('hidden');
                userDropdown.classList.remove('dropdown-enter');
                dropdownArrow.style.transform = 'rotate(0deg)';
            }
        }

        if (userDropdownBtn) {
            userDropdownBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleUserDropdown();
            });
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
            // Close user dropdown if clicking outside
            if (userDropdown && !userDropdown.contains(e.target) && userDropdownBtn && !userDropdownBtn.contains(e.target)) {
                if (isDropdownOpen) {
                    toggleUserDropdown();
                }
            }
        });

        // Close dropdown on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isDropdownOpen) {
                toggleUserDropdown();
            }
        });

    </script>
</body>
</html>